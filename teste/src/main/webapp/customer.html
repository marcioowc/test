<!DOCTYPE html>
<html ng-app="myapp">
<head>
<meta charset="ISO-8859-1">
<title>Insert title here</title>
<script type="text/javascript" src="js/lib/angular/angular.min.js"></script>
</head>
<body ng-controller="customerController">
	<table id="table-1" border="1" cellpadding="2" cellspacing="2">
			<tr>
				<th>ID</th>
				<th>CPF/CNPJ</th>
				<th>Nome</th>
				<th></th>
			</tr>
			<tr ng-repeat="customer in result">
				<td>{{customer.id}}</td>
				<td>{{customer.idFederac}}</td>
				<td>{{customer.name}}</td>
				<td>
					<a href="#" ng-click="del(customer.id)">Delete</a>
					<a href="#" ng-click="edit(customer)">Edit</a>
				</td>
			</tr>
	</table>
	<br/>
	<fieldset>
		<legend>Informações do Cliente</legend>
		<table id="table-1" cellpadding="2" cellspacing="2">
			<tr>
				<td>CPF/CNPJ</td>
				<td><input type="text" ng-model="customer.idFederac"></td>
			</tr>
			<tr>
				<td>Nome</td>
				<td><input type="text" ng-model="customer.name"></td>
			</tr>
			<tr>
				<td>&nbsp;</td>
				<td>
					<input type="button" value="Adicionar" ng-click="add()">
					<input type="button" value="Atualizar" ng-click="update()">
				</td>
			</tr>
		</table>
	</fieldset>
	<script type="text/javascript">
		var myapp = angular.module('myapp', []);
		myapp.controller('customerController', function($scope, $http){
			$scope.base_url = 'http://localhost:8080/teste/rest/customers/';
			$http.get($scope.base_url + 'getAllCustomers').success(function(response){
				$scope.result = response.data;
			});

			$scope.add = function(){
				$http.post($scope.base_url, $scope.customer).success(function(response){
					$http.get($scope.base_url + 'getAllCustomers').success(function(response){
						$scope.result = response.data;
					});
				});
			};

			$scope.del = function(id){
				var result = confirm('Tem certeza que deseja deletar o registro?');
				if(result == true){
					$http.delete($scope.base_url + 'deleteCustomer/' + id).success(function(response){
						$http.get($scope.base_url + 'getAllCustomers').success(function(response){
							$scope.result = response.data;
						});
					});
				}				
			};

			$scope.edit = function(customer){
				$scope.customer = customer;
				
			};

			$scope.update = function(){
				$http.put($scope.base_url, $scope.customer).success(function(response){
					$http.get($scope.base_url + 'getAllCustomers').success(function(response){
						$scope.result = response.data;
					});
				});
			};
		});
	</script>

</body>
</html>